# Tic-tac-toe game

Проект для запуска игр в крестики-нолики между ботами. Подробные инструкции по запуску [back-end](mediator),
[web UI](ui), [тестового бота](bot) можно найти в соответствующих директориях.

Для удобного просмотра спецификаций из [директории](specs) советую воспользоваться [сайтом](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwil24-HuLCCAxWYHRAIHbScCogQFnoECAkQAQ&url=https%3A%2F%2Feditor.swagger.io%2F&usg=AOvVaw0JrxGe9QVE_4Oek2M7IeVv&opi=89978449). 

## Требования к боту
1. Завернут в Docker container
2. Через env переменные передаются следующие конфиги
    1. SESSION_ID – id сессии, в которой должен участвовать бот
    2. BOT_URL – url для обратной коммуникации медиатора с ботом. Должен передаваться в запросе на регистрацию в сессии
    3. MEDIATOR_URL – base url, по которому бот может зарегистрироваться в сессии
3. Поддерживает [контракт](specs/service_bot_spec.yaml)
4. Бот должен:
   * отвечать на запрос хода в течение 1 сек
   * сделать ход выданной ему при регистрации бота в сессии фигурой (см ход игры)
   * за ход менять только одно поле
   * менять только незанятое поле
   * при нарушении любого из этих требований ход не будет засчитан и победа автоматически присуждается оппоненту

## Ход игры
0. При начале турнира организаторы выдают командам логин и пароль. Они должны будут быть использованы ботом на шаге 
   регистрации в игровой сессии. Эти параметры должны быть записаны в самом боте и не будут передаваться через env 
   переменные
1. Организатор запускает игровую сессию между ботами, каждый бот при запуске вызывает метод `${MEDIATOR_URL}/sessions$/{SESSION_ID}/registration` (см [контракт](specs/service_bot_spec.yaml))
2. Сервис медиатор отвечает боту, за какую фигуру он должен играть
3. Сервис медиатор поочередно запрашивает у ботов их шаги через метод `/bot/turn` (см [контракт](specs/service_bot_spec.yaml))
4. После окончания игры 3 очка присуждается боту-победителю
5. На круговом этапе проводятся 5 игры между всеми парами ботов. Первые n ботов выходят в стыковые игры в формате 
   [плей-офф](https://ru.wikipedia.org/wiki/Олимпийская_система). Число n будет определяться организаторами исходя 
   из количества изначальных участников, зарегистрировавшихся в турнире.

Для примера рабочего бота можно посмотреть код [тестового бота](bot) и даже воспользоваться его кодом для построения 
своего.

## Как запустить локально

### Для корректной работы проекта понадобятся корректно настроенные:

* python
* установленная библиотека [docker-py](https://docker-py.readthedocs.io/en/stable/index.html))
* Node js
* Docker

### Порядок запуска:

1. Запустить [backend](mediator) по [инструкции](mediator/README.md)
2. Запустить [web UI](ui) по [инструкции](ui/README.md)
3. Собрать [тестового бота](bot) по [инструкции](bot/README.md)
4. Зарегистрировать всех ботов участников через вызов Restful endpoint

```shell
curl --location --request PUT 'http://localhost:8080/commands/{bot-id}' \
--header 'Content-Type: text/plain' \
--data '{bot-password}'
```

Вы можете использовать любую пару логин/пароль для своего бота. Но при запуске бота он должен передать логин/пароль для
регистрации.

5. Запустить ботов в web UI по [инструкции](ui/README.md), либо в консоли по [инструкции](scripts/README.md).

## Если есть желание помочь проекту
Есть [список](tasks.md) задач, которые можно выполнить, чтобы улучшить проект. Заранее спасибо) 